import{LitElement as e,html as l,css as t}from"lit";import{styleMap as o}from"lit/directives/style-map.js";import{property as a,state as s,customElement as i}from"lit/decorators.js";import{ReactiveState as r}from"../../state/reactive-state.js";import{allowedWallets$ as d,modalTheme$ as n}from"../../state/store.js";import{modalDialogStyles as c,modalDialogBodyStyles as h,modalHelpSection as v,backdropStyles as b,modalAnimations as p,modalWalletsSection as m}from"./styles.js";var g=Object.defineProperty,u=Object.getOwnPropertyDescriptor,w=(e,l,t,o)=>{for(var a,s=o>1?void 0:o?u(l,t):l,i=e.length-1;i>=0;i--)(a=e[i])&&(s=(o?a(l,t,s):a(s))||s);return o&&s&&g(l,t,s),s};const f={DARK:{bgColor:"#161616",textColor:"#a0a0a0",solidTextColor:"#ededed",headerButtonColor:"#707070",dividerColor:"rgba(255, 255, 255, 0.15)",helpBgColor:"#1c1c1c",notAvailableTextColor:"#a0a0a0",notAvailableBgColor:"#232323",notAvailableBorderColor:"#343434"},LIGHT:{bgColor:"#fcfcfc",textColor:"#181818",solidTextColor:"#000000",headerButtonColor:"#8f8f8f",dividerColor:"rgba(0, 0, 0, 0.15)",helpBgColor:"#f8f8f8",notAvailableTextColor:"#6f6f6f",notAvailableBgColor:"#f3f3f3",notAvailableBorderColor:"#e2e2e2"}};let x=class extends e{constructor(){super(...arguments),this.ignoreShowStatus=!1,this.showModal=!1,this.closingModal=!1,this.modalTitle="Connect a Wallet",this.notAvailableText="Not available",this.allowedWallets=new r(this,d),this.theme=new r(this,n)}connectedCallback(){super.connectedCallback()}async closeModal(){this.closingModal=!0,await new Promise((e=>setTimeout(e,280))),this.ignoreShowStatus||(this.showModal=!1),this.dispatchEvent(new CustomEvent("modal-closed",{detail:new Error("Modal closed"),bubbles:!0,composed:!0})),this.closingModal=!1}async pickWalletOption(e){if(e.isAvailable){this.closingModal=!0,await new Promise((e=>setTimeout(e,280)));try{const l=window.localStorage.getItem("@StellarWalletsKit/usedWalletsIds");let t=l?JSON.parse(l):[];t=[e.id,...t.filter((l=>l!==e.id))],window.localStorage.setItem("@StellarWalletsKit/usedWalletsIds",JSON.stringify(t))}catch(e){console.error(e)}this.dispatchEvent(new CustomEvent("wallet-selected",{detail:e,bubbles:!0,composed:!0})),this.closingModal=!1}else window.open(e.url,"_blank")}getSortedList(){const e=this.allowedWallets.value.reduce(((e,l)=>({available:l.isAvailable?[...e.available,l]:e.available,unavailable:l.isAvailable?e.unavailable:[...e.unavailable,l]})),{available:[],unavailable:[]});let l;try{const e=window.localStorage.getItem("@StellarWalletsKit/usedWalletsIds");l=e?JSON.parse(e):[]}catch(e){console.error(e),l=[]}if(0===l.length)return[...e.available,...e.unavailable];const t=[],o=[];for(const a of e.available)l.find((e=>e===a.id))?t.push(a):o.push(a);return[...t.sort(((e,t)=>l.indexOf(e.id)-l.indexOf(t.id))),...o,...e.unavailable]}getThemeStyles(){return this.theme.value?{"--modal-bg-color":this.theme.value.bgColor,"--modal-text-color":this.theme.value.textColor,"--modal-solid-text-color":this.theme.value.solidTextColor,"--modal-header-button-color":this.theme.value.headerButtonColor,"--modal-divider-color":this.theme.value.dividerColor,"--modal-help-bg-color":this.theme.value.helpBgColor,"--modal-not-available-text-color":this.theme.value.notAvailableTextColor,"--modal-not-available-bg-color":this.theme.value.notAvailableBgColor,"--modal-not-available-border-color":this.theme.value.notAvailableBorderColor}:{}}render(){const e=l`
      <section class="help-container">
        <header class="help-header">
          <h2 class="help-header__modal-title dialog-text-solid">Learn more</h2>
        </header>

        <div class="help__whats_a_wallet">
          <h2 class="dialog-text-solid help__title">What is a wallet?</h2>
          <p class="dialog-text help__text">
            Wallets are used to send, receive, and store the keys you use to sign blockchain transactions.
          </p>
        </div>

        <div class="help__whats_stellar">
          <h2 class="dialog-text-solid help__title">What is Stellar?</h2>
          <p class="dialog-text help__text">
            Stellar is a decentralized, public blockchain that gives developers the tools to create experiences that are
            more like cash than crypto
          </p>
        </div>
      </section>
    `,t=l`
      <section class="wallets-container">
        <header class="wallets-header">
          <h2 class="wallets-header__modal-title dialog-text-solid">${this.modalTitle}</h2>

          <button @click=${()=>this.closeModal()} class="wallets-header__button">
            <svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="20px" width="20px" viewBox="0 0 490 490">
              <polygon
                points="456.851,0 245,212.564 33.149,0 0.708,32.337 212.669,245.004 0.708,457.678 33.149,490 245,277.443 456.851,490   489.292,457.678 277.331,245.004 489.292,32.337 " />
            </svg>
          </button>
        </header>

        <ul class="wallets-body">
          ${this.getSortedList().map(((e,t)=>l`
                <li
                  @click=${()=>this.pickWalletOption(e)}
                  class=" wallets-body__item ${e.isAvailable?"":"not-available"} ${t===this.allowedWallets.value.length-1?"mb-0":""}">
                  <img src=${e.icon} alt=${e.name} />
                  <span class="dialog-text-solid">${e.name}</span>
                  ${e.isAvailable?"":l`<small class="not-available">${this.notAvailableText}</small>`}
                </li>
              `))}
        </ul>
      </section>
    `;return l`
      <dialog
        style=${o(this.getThemeStyles())}
        class="dialog-modal ${this.closingModal?"closing":""}"
        .open=${this.showModal}>
        <section class="dialog-modal-body">
          <div class="dialog-modal-body__help">${e}</div>
          <div class="dialog-modal-body__wallets">${t}</div>
        </section>
      </dialog>

      <div
        style="position: fixed; z-index: 950"
        class="backdrop ${this.closingModal?"closing":""}"
        @click=${()=>this.closeModal()}></div>
    `}};x.styles=[t`
      :host * {
        box-sizing: border-box;
      }

      .mb-0 {
        margin-bottom: 0 !important;
      }
    `,c,h,v,b,p,m],w([a({type:Boolean,reflect:!0})],x.prototype,"ignoreShowStatus",2),w([a({type:Boolean,reflect:!0})],x.prototype,"showModal",2),w([s()],x.prototype,"closingModal",2),w([a({type:String,reflect:!0})],x.prototype,"modalTitle",2),w([a({type:String,reflect:!0})],x.prototype,"notAvailableText",2),x=w([i("stellar-wallets-modal")],x);export{f as ModalThemes,x as StellarWalletsModal};
//# sourceMappingURL=stellar-wallets-modal.js.map
