"use strict";var l=require("lit"),e=require("lit/directives/style-map.js"),t=require("lit/decorators.js"),a=require("../../state/reactive-state.cjs"),o=require("../../state/store.cjs"),s=require("./styles.cjs"),i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,d=(l,e,t,a)=>{for(var o,s=a>1?void 0:a?r(e,t):e,d=l.length-1;d>=0;d--)(o=l[d])&&(s=(a?o(e,t,s):o(s))||s);return a&&s&&i(e,t,s),s};exports.StellarWalletsModal=class extends l.LitElement{constructor(){super(...arguments),this.ignoreShowStatus=!1,this.showModal=!1,this.closingModal=!1,this.modalTitle="Connect a Wallet",this.notAvailableText="Not available",this.allowedWallets=new a.ReactiveState(this,o.allowedWallets$),this.theme=new a.ReactiveState(this,o.modalTheme$)}connectedCallback(){super.connectedCallback()}async closeModal(){this.closingModal=!0,await new Promise((l=>setTimeout(l,280))),this.ignoreShowStatus||(this.showModal=!1),this.dispatchEvent(new CustomEvent("modal-closed",{detail:new Error("Modal closed"),bubbles:!0,composed:!0})),this.closingModal=!1}async pickWalletOption(l){if(l.isAvailable){this.closingModal=!0,await new Promise((l=>setTimeout(l,280)));try{const e=window.localStorage.getItem("@StellarWalletsKit/usedWalletsIds");let t=e?JSON.parse(e):[];t=[l.id,...t.filter((e=>e!==l.id))],window.localStorage.setItem("@StellarWalletsKit/usedWalletsIds",JSON.stringify(t))}catch(l){console.error(l)}this.dispatchEvent(new CustomEvent("wallet-selected",{detail:l,bubbles:!0,composed:!0})),this.closingModal=!1}else window.open(l.url,"_blank")}getSortedList(){const l=this.allowedWallets.value.reduce(((l,e)=>({available:e.isAvailable?[...l.available,e]:l.available,unavailable:e.isAvailable?l.unavailable:[...l.unavailable,e]})),{available:[],unavailable:[]});let e;try{const l=window.localStorage.getItem("@StellarWalletsKit/usedWalletsIds");e=l?JSON.parse(l):[]}catch(l){console.error(l),e=[]}if(0===e.length)return[...l.available,...l.unavailable];const t=[],a=[];for(const o of l.available)e.find((l=>l===o.id))?t.push(o):a.push(o);return[...t.sort(((l,t)=>e.indexOf(l.id)-e.indexOf(t.id))),...a,...l.unavailable]}getThemeStyles(){return this.theme.value?{"--modal-bg-color":this.theme.value.bgColor,"--modal-text-color":this.theme.value.textColor,"--modal-solid-text-color":this.theme.value.solidTextColor,"--modal-header-button-color":this.theme.value.headerButtonColor,"--modal-divider-color":this.theme.value.dividerColor,"--modal-help-bg-color":this.theme.value.helpBgColor,"--modal-not-available-text-color":this.theme.value.notAvailableTextColor,"--modal-not-available-bg-color":this.theme.value.notAvailableBgColor,"--modal-not-available-border-color":this.theme.value.notAvailableBorderColor}:{}}render(){const t=l.html`
      <section class="help-container">
        <header class="help-header">
          <h2 class="help-header__modal-title dialog-text-solid">Learn more</h2>
        </header>

        <div class="help__whats_a_wallet">
          <h2 class="dialog-text-solid help__title">What is a wallet?</h2>
          <p class="dialog-text help__text">
            Wallets are used to send, receive, and store the keys you use to sign blockchain transactions.
          </p>
        </div>

        <div class="help__whats_stellar">
          <h2 class="dialog-text-solid help__title">What is Stellar?</h2>
          <p class="dialog-text help__text">
            Stellar is a decentralized, public blockchain that gives developers the tools to create experiences that are
            more like cash than crypto
          </p>
        </div>
      </section>
    `,a=l.html`
      <section class="wallets-container">
        <header class="wallets-header">
          <h2 class="wallets-header__modal-title dialog-text-solid">${this.modalTitle}</h2>

          <button @click=${()=>this.closeModal()} class="wallets-header__button">
            <svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="20px" width="20px" viewBox="0 0 490 490">
              <polygon
                points="456.851,0 245,212.564 33.149,0 0.708,32.337 212.669,245.004 0.708,457.678 33.149,490 245,277.443 456.851,490   489.292,457.678 277.331,245.004 489.292,32.337 " />
            </svg>
          </button>
        </header>

        <ul class="wallets-body">
          ${this.getSortedList().map(((e,t)=>l.html`
                <li
                  @click=${()=>this.pickWalletOption(e)}
                  class=" wallets-body__item ${e.isAvailable?"":"not-available"} ${t===this.allowedWallets.value.length-1?"mb-0":""}">
                  <img src=${e.icon} alt=${e.name} />
                  <span class="dialog-text-solid">${e.name}</span>
                  ${e.isAvailable?"":l.html`<small class="not-available">${this.notAvailableText}</small>`}
                </li>
              `))}
        </ul>
      </section>
    `;return l.html`
      <dialog
        style=${e.styleMap(this.getThemeStyles())}
        class="dialog-modal ${this.closingModal?"closing":""}"
        .open=${this.showModal}>
        <section class="dialog-modal-body">
          <div class="dialog-modal-body__help">${t}</div>
          <div class="dialog-modal-body__wallets">${a}</div>
        </section>
      </dialog>

      <div
        style="position: fixed; z-index: 950"
        class="backdrop ${this.closingModal?"closing":""}"
        @click=${()=>this.closeModal()}></div>
    `}},exports.StellarWalletsModal.styles=[l.css`
      :host * {
        box-sizing: border-box;
      }

      .mb-0 {
        margin-bottom: 0 !important;
      }
    `,s.modalDialogStyles,s.modalDialogBodyStyles,s.modalHelpSection,s.backdropStyles,s.modalAnimations,s.modalWalletsSection],d([t.property({type:Boolean,reflect:!0})],exports.StellarWalletsModal.prototype,"ignoreShowStatus",2),d([t.property({type:Boolean,reflect:!0})],exports.StellarWalletsModal.prototype,"showModal",2),d([t.state()],exports.StellarWalletsModal.prototype,"closingModal",2),d([t.property({type:String,reflect:!0})],exports.StellarWalletsModal.prototype,"modalTitle",2),d([t.property({type:String,reflect:!0})],exports.StellarWalletsModal.prototype,"notAvailableText",2),exports.StellarWalletsModal=d([t.customElement("stellar-wallets-modal")],exports.StellarWalletsModal),exports.ModalThemes={DARK:{bgColor:"#161616",textColor:"#a0a0a0",solidTextColor:"#ededed",headerButtonColor:"#707070",dividerColor:"rgba(255, 255, 255, 0.15)",helpBgColor:"#1c1c1c",notAvailableTextColor:"#a0a0a0",notAvailableBgColor:"#232323",notAvailableBorderColor:"#343434"},LIGHT:{bgColor:"#fcfcfc",textColor:"#181818",solidTextColor:"#000000",headerButtonColor:"#8f8f8f",dividerColor:"rgba(0, 0, 0, 0.15)",helpBgColor:"#f8f8f8",notAvailableTextColor:"#6f6f6f",notAvailableBgColor:"#f3f3f3",notAvailableBorderColor:"#e2e2e2"}};
//# sourceMappingURL=stellar-wallets-modal.cjs.map
