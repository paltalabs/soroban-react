"use strict";var e=require("./interfaces.cjs");exports.xBullSDK=class{constructor(){this.isConnected=!1}sendEventToContentScript(e,r,t){return new Promise((o=>{const n=e=>{if(e.source!==window||!e.data||e.origin!==window.origin)return;e.data.eventId===t&&(o(e),window.removeEventListener("message",n,!1))};window.addEventListener("message",n,!1),window.webkit.messageHandlers.cordova_iab.postMessage(JSON.stringify({type:e,eventId:t,detail:r}))}))}async enableConnection(){const r={origin:window.origin,host:window.location.host,permissions:{canRequestPublicKey:!0,canRequestSign:!0}},t=await this.sendEventToContentScript(e.EventType.XBULL_CONNECT,r,crypto.randomUUID()),{detail:o}=t.data;if(!o||o.error)throw{code:o?.code||-1,message:o?.errorMessage||"Unexpected error"};this.isConnected=!0}async getAddress(){try{await this.enableConnection()}catch(e){return{error:{code:e?.code||-1,message:e?.message||"Unexpected error"}}}const r={origin:window.origin,host:window.location.host},t=await this.sendEventToContentScript(e.EventType.XBULL_GET_PUBLIC_KEY,r,crypto.randomUUID()),{detail:o}=t.data;return!o||o.error?{error:{code:o?.code||-1,message:o?.errorMessage||"Unexpected error"}}:{address:o.payload}}async signTransaction(r){if(r.opts?.submit||r.opts?.submitUrl)return{error:{code:-1,message:"Parameters `submit` and `submitUrl` are not supported"}};try{await this.enableConnection()}catch(e){return{error:{code:e?.code||-1,message:e?.message||"Unexpected error"}}}const t={origin:window.origin,host:window.location.host,network:r.opts?.networkPassphrase,publicKey:r.opts?.address,xdr:r.xdr,xdrType:"Transaction"},o=await this.sendEventToContentScript(e.EventType.XBULL_SIGN_XDR,t,crypto.randomUUID()),{detail:n}=o.data;return!n||n.error?{error:{code:n?.code||-1,message:n?.errorMessage||"Unexpected error"}}:{signedTxXdr:n.payload.signedXdr,signerAddress:n.payload.signerAddress}}async getNetwork(){try{await this.enableConnection()}catch(e){return{error:{code:e?.code||-1,message:e?.message||"Unexpected error"}}}const r={origin:window.origin,host:window.location.host},t=await this.sendEventToContentScript(e.EventType.XBULL_GET_NETWORK,r,crypto.randomUUID()),{detail:o}=t.data;return!o||o.error?{error:{code:o?.code||-1,message:o?.errorMessage||"Unexpected error"}}:{network:o.payload.network,networkPassphrase:o.payload.networkPassphrase}}};
//# sourceMappingURL=mobile-sdk.cjs.map
