"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TorSocket = void 0;
const tslib_1 = require("tslib");
const base_1 = require("./base");
class TorSocket extends base_1.SocketBase {
    constructor(_a) {
        var { proxyAgent } = _a, rest = tslib_1.__rest(_a, ["proxyAgent"]);
        super(rest);
        this.proxyAgent = proxyAgent;
    }
    openSocket(listener) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { host, port } = this;
            const socket = yield this.proxyAgent
                .connect(null, { host, port, timeout: this.timeout, secureEndpoint: false })
                .catch(e => {
                listener.onError(e);
                throw e;
            });
            listener.onConnect();
            this.configureSocket(socket);
            this.bindSocket(socket, listener);
            return socket;
        });
    }
}
exports.TorSocket = TorSocket;
//# sourceMappingURL=tor.js.map